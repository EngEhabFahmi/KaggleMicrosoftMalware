__author__ = "Cody Wild"

"""
Converts text file format output by Spark into usable CSV format
"""


from ast import literal_eval
import csv
import numpy as np
import re

#for train, test
f = open('/Users/codywild/Desktop/MSAN/Module3/AdvancedML/KaggleMicrosoftMalware/data/w2v/idata/fiftyPerc/idataVecTrain.txt')
fileName = ''
resultFile = open('/Users/codywild/Desktop/MSAN/Module3/AdvancedML/KaggleMicrosoftMalware/data/w2v/idata/fiftyPerc/idataVecTrain.csv','wb')
wr = csv.writer(resultFile)
i = 0
for line in f:
    if i == 0:
        i += 1
        continue
    try:
        l = literal_eval(line)
        output = [l[0]]
        output.extend(l[1])
    except SyntaxError:
        output = [line[3:23]]
        fileNameMatch = re.match('[A-Za-z0-9]{20}', output[0])
        if not fileNameMatch:
            continue
        else:
            output.extend(list(np.zeros(500)))
    wr.writerow(output)
    i += 1
    print i
resultFile.close()